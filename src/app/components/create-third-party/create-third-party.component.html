<form [formGroup]="tpForm">
  <h2 mat-dialog-title>{{title}}</h2>
  <div mat-dialog-content>
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h5>Main Details</h5>
        </div>

        <div class="col-md-4 col-sm-12">
          <div class="form-group input-group mb-3">
            <div class="input-group-prepend">
              <label class="input-group-text" for="inputGroupSelect01">Create a</label>
            </div>

            <select class="custom-select mr-sm-2" formControlName="policyHolderType"
              [(ngModel)]="thirdParty.policyHolderType">
              <option value="P" selected>Person</option>
              <option value="C">Company/Organization</option>
            </select>

          </div>
        </div>

        <div class="clearfix"></div>

        <div class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['documentType'].invalid 
            && (tpForm.controls['documentType'].dirty 
            || tpForm.controls['documentType'].touched)}">
            <label for="documentType">Document Type</label>
            <select class="custom-select mr-sm-2 required" formControlName="documentType"
              [(ngModel)]="thirdParty.documentType">
              <option selected></option>
              <option *ngFor="let type of TPLOV.documentTypeLOV" [ngValue]="type.TIP_DOCUM">{{ type.NOM_DOCUM }}</option>
            </select>
            <p class="form-error" *ngIf="tpForm.controls['documentType'].errors?.required">
              * document type is required
            </p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['documentCode'].invalid 
            && (tpForm.controls['documentCode'].dirty 
            || tpForm.controls['documentCode'].touched)}">
            <label for="documentCode">Document Code</label>
            <input type="text" formControlName="documentCode" class="form-control required"
              oninput="this.value = this.value.toUpperCase()"
              [(ngModel)]="thirdParty.documentCode">
            <p class="form-error" *ngIf="tpForm.controls['documentCode'].errors?.required">
              * document code is required
            </p>
          </div>
        </div>

        <div class="clearfix"></div>

        <div *ngIf="showPersonDetails" class="col-md-4">
          <div class="form-group">
            <label for="prefix">Prefix</label>
            <select class="custom-select mr-sm-2" formControlName="prefix" [(ngModel)]="thirdParty.prefix">
              <option selected></option>
              <option *ngFor="let pre of TPLOV.prefixLOV" [ngValue]="pre.TIP_PREFIJO_NOMBRE">{{ pre.NOM_VALOR }}</option>
            </select>
          </div>
        </div>

        <div *ngIf="showPersonDetails" class="col-md-4">
          <div class="form-group">
            <label for="suffix">Suffix</label>
            <select class="custom-select mr-sm-2" formControlName="suffix" [(ngModel)]="thirdParty.suffix">
              <option selected></option>
              <option *ngFor="let suff of TPLOV.suffixLOV" [ngValue]="suff.TIPO_SUFIJO_NOMBRE">{{ suff.NOM_VALOR }}</option>
            </select>
          </div>
        </div>

        <div class="clearfix"></div>

        <div class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['firstName'].invalid 
                && (tpForm.controls['firstName'].dirty 
                || tpForm.controls['firstName'].touched)}">
            <label for="suffix">{{firstNameLabel}}</label>
            <input type="text" formControlName="firstName" class="form-control required"
              oninput="this.value = this.value.toUpperCase()" [(ngModel)]="thirdParty.firstName">
            <p class="form-error" *ngIf="tpForm.controls['firstName'].errors?.required">
              * {{firstNameError}} is required
            </p>
          </div>
        </div>

        <div *ngIf="showPersonDetails" class="col-md-4">
          <div class="form-group">
            <label for="suffix">Middle Name</label>
            <input type="text" formControlName="middleName" class="form-control"
              oninput="this.value = this.value.toUpperCase()" [(ngModel)]="thirdParty.middleName">
          </div>
        </div>

        <div *ngIf="showPersonDetails" class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['lastName'].invalid 
                && (tpForm.controls['lastName'].dirty 
                || tpForm.controls['lastName'].touched)}">
            <label for="suffix">Last Name</label>
            <input type="text" formControlName="lastName" class="form-control required"
              oninput="this.value = this.value.toUpperCase()" [(ngModel)]="thirdParty.lastName">
            <p class="form-error" *ngIf="tpForm.controls['lastName'].errors?.required">
              * last name is required
            </p>
          </div>
        </div>

        <div *ngIf="showPersonDetails" class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['gender'].invalid 
              && (tpForm.controls['gender'].dirty 
              || tpForm.controls['gender'].touched)}">
            <label for="gender">Gender</label>
            <select class="custom-select mr-sm-2 required" formControlName="gender" [(ngModel)]="thirdParty.gender" convert-to-number> 
              <option selected></option>
              <option [ngValue]="1">MALE</option>
              <option [ngValue]="0">FEMALE</option>
            </select>
            <p class="form-error" *ngIf="tpForm.controls['gender'].errors?.required">
              * gender is required
            </p>
          </div>
        </div>

        <div *ngIf="showPersonDetails" class="col-md-4">
          <div class="form-group">
            <label for="purchaseDate">Birth Date</label>
            <input type="text" placeholder="Datepicker" class="form-control" [maxDate]="today"
              formControlName="birthDate" [(ngModel)]="thirdParty.birthDate" bsDatepicker>
          </div>
        </div>

        <div class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['mobileNumber'].invalid 
            && (tpForm.controls['mobileNumber'].dirty 
            || tpForm.controls['mobileNumber'].touched)}">
            <label for="suffix">Mobile Number</label>
            <input type="text" formControlName="mobileNumber" class="form-control required"
              [(ngModel)]="thirdParty.mobileNumber"
              maxlength="12">
            <p class="form-error" *ngIf="tpForm.controls['mobileNumber'].errors?.required">
              * mobile number is required
            </p>
          </div>
        </div>

        <div class="col-md-12">
          <h5>Address</h5>
        </div>

        <div class="col-md-4">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['correspondenceType'].invalid 
                && (tpForm.controls['correspondenceType'].dirty 
                || tpForm.controls['correspondenceType'].touched)}">
            <label for="correspondenceType">Correspondence Type</label>
            <select class="custom-select mr-sm-2 required" formControlName="correspondenceType"
              [(ngModel)]="thirdParty.correspondenceType">
              <option *ngFor="let correspondenceType of TPLOV.correspondenceTypeLOV"
                [ngValue]="correspondenceType.TIP_ETIQUETA">{{ correspondenceType.NOM_VALOR }}</option>
            </select>
            <p class="form-error" *ngIf="tpForm.controls['correspondenceType'].errors?.required">
              * correspondence type is required
            </p>
          </div>
        </div>

        <div class="clearfix"></div>

        <div class="col-md-6">
          <div class="form-group">
            <label for="gender">Country</label>
            <select class="custom-select mr-sm-2" formControlName="country" [(ngModel)]="thirdParty.country"
                (change)="getState()">
              <option selected></option>
              <option *ngFor="let country of TPLOV.countryLOV" [ngValue]="country.COD_PAIS">{{ country.NOM_PAIS }}
              </option>
            </select>
          </div>
        </div>

        <div class="col-md-6">
          <div class="form-group">
            <label for="gender">State</label>
            <select class="custom-select mr-sm-2" formControlName="state" [(ngModel)]="thirdParty.state"
                (change)="getProvince()">
              <option selected></option>
              <option *ngFor="let state of TPLOV.stateLOV" [ngValue]="state.COD_ESTADO">{{ state.NOM_ESTADO }}
              </option>
            </select>
          </div>
        </div>

        <div class="col-md-6">
          <div class="form-group">
            <label for="province">Province</label>
            <select class="custom-select mr-sm-2" formControlName="province" [(ngModel)]="thirdParty.province"
                (change)="getCity()">
              <option selected></option>
              <option *ngFor="let province of TPLOV.provinceLOV" [ngValue]="province.COD_PROV">
                {{ province.NOM_PROV }}
              </option>
            </select>
          </div>
        </div>

        <div class="col-md-6">
          <div class="form-group">
            <label for="gender">Town/City</label>
            <select class="custom-select mr-sm-2" formControlName="city" [(ngModel)]="thirdParty.city"
                (change)="getZipCode()">
              <option selected></option>
              <option *ngFor="let city of TPLOV.cityLOV" [ngValue]="city.COD_LOCALIDAD">
                {{ city.NOM_LOCALIDAD }}
              </option>
            </select>
          </div>
        </div>

        <div class="col-lg-12">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['address'].invalid 
            && (tpForm.controls['address'].dirty 
            || tpForm.controls['address'].touched)}">
            <label for="address">Address</label>
            <textarea type="text" formControlName="address" class="form-control required"
              oninput="this.value = this.value.toUpperCase()" 
              [(ngModel)]="thirdParty.address"></textarea>
            <p class="form-error" *ngIf="tpForm.controls['address'].errors?.required">
              * address required
            </p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="form-group">
            <label for="gender">Zipcode</label>
            <select class="custom-select mr-sm-2" formControlName="zipcode" [(ngModel)]="thirdParty.zipcode">
              <option *ngFor="let zipcode of TPLOV.zipcodeLOV" [ngValue]="zipcode.COD_POSTAL">
                {{ zipcode.COD_POSTAL }}
              </option>
            </select>
          </div>
        </div>

        <div class="col-md-8">
          <div class="form-group" [ngClass]="{'input-error': tpForm.controls['email'].invalid 
              && (tpForm.controls['email'].dirty 
              || tpForm.controls['email'].touched)}">
            <label for="email">Email</label>
            <input type="text" formControlName="email" class="form-control required" [(ngModel)]="thirdParty.email">
            <p class="form-error" *ngIf="tpForm.controls['email'].errors?.required">
              * email is required
            </p>
            <p class="form-error" *ngIf="tpForm.controls['email'].errors?.email">
              * invalid email format
            </p>
          </div>
        </div>

        <div *ngIf="showOrgDetails" class="col-xl-12">
          <div class="row">
            <div class="col-md-12">
              <h5>Company/Organization Data <small>(Optional)</small></h5>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="orgDocumentType">Contact Document Type</label>
                <select class="custom-select mr-sm-2" formControlName="orgDocumentType"
                  [(ngModel)]="thirdParty.orgDocumentType">
                  <option selected></option>
                  <option *ngFor="let documentType of TPLOV.documentTypeLOV" [ngValue]="documentType.COD_DOCUM">
                    {{ documentType.NOM_DOCUM }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="orgDocumentCode">Contact Document Code</label>
                <input type="text" formControlName="orgDocumentCode" class="form-control"
                  [(ngModel)]="thirdParty.orgDocumentCode">
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="orgNationality">Nationality</label>
                <select class="custom-select mr-sm-2" formControlName="orgNationality"
                  [(ngModel)]="thirdParty.orgNationality">
                  <option selected></option>
                  <option *ngFor="let nationality of TPLOV.nationalityLOV" [ngValue]="nationality.COD_PAIS">
                    {{ nationality.NOM_PAIS }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label for="orgFirstName">Contact First Name</label>
                <input type="text" formControlName="orgFirstName" class="form-control"
                  [(ngModel)]="thirdParty.orgFirstName">
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label for="orgLastName">Contact Last Name</label>
                <input type="text" formControlName="orgLastName" class="form-control"
                  [(ngModel)]="thirdParty.orgLastName">
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label for="orgPost">Post</label>
                <select class="custom-select mr-sm-2" formControlName="orgPost" [(ngModel)]="thirdParty.orgPost">
                  <option selected></option>
                  <option *ngFor="let orgPost of TPLOV.orgPostLOV" [ngValue]="orgPost.COD_MARCA">
                    {{ orgPost.NOM_MARCA }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label for="orgTypeOfBusiness">Type of Business</label>
                <select class="custom-select mr-sm-2" formControlName="orgTypeOfBusiness"
                  [(ngModel)]="thirdParty.orgTypeOfBusiness">
                  <option selected></option>
                  <option *ngFor="let orgTypeOfBusiness of TPLOV.orgTypeOfBusinessLOV"
                    [ngValue]="orgTypeOfBusiness.COD_MARCA">
                    {{ orgTypeOfBusiness.NOM_MARCA }}
                  </option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="showPersonDetails" class="col-xl-12">
          <div class="row">
            <div class="col-md-12">
              <h5>Natural Person Data <small>(Optional)</small></h5>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="personMaritalStatus">Marital Status</label>
                <select class="custom-select mr-sm-2" formControlName="personMaritalStatus"
                  [(ngModel)]="thirdParty.personMaritalStatus">
                  <option selected></option>
                  <option *ngFor="let personMaritalStatus of TPLOV.personMaritalStatusLOV"
                    [ngValue]="personMaritalStatus.COD_EST_CIVIL">
                    {{ personMaritalStatus.NOM_VALOR }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="personProfession">Profession</label>
                <select class="custom-select mr-sm-2" formControlName="personProfession"
                  [(ngModel)]="thirdParty.personProfession">
                  <option selected></option>
                  <option *ngFor="let personProfession of TPLOV.personProfessionLOV"
                    [ngValue]="personProfession.COD_PROFESION">
                    {{ personProfession.NOM_PROFESION }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="personOccupation">Occupation</label>
                <select class="custom-select mr-sm-2" formControlName="personOccupation"
                  [(ngModel)]="thirdParty.personOccupation">
                  <option selected></option>
                  <option *ngFor="let personOccupation of TPLOV.personOccupationLOV"
                    [ngValue]="personOccupation.COD_PROFESION">
                    {{ personOccupation.NOM_PROFESION }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="personNationality">Nationality</label>
                <select class="custom-select mr-sm-2" formControlName="personNationality"
                  [(ngModel)]="thirdParty.personNationality">
                  <option selected></option>
                  <option *ngFor="let nationality of TPLOV.nationalityLOV" [ngValue]="nationality.COD_PAIS">
                    {{ nationality.NOM_PAIS }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label for="personType">Type</label>
                <select class="custom-select mr-sm-2" formControlName="personType" [(ngModel)]="thirdParty.personType">
                  <option selected></option>
                  <option *ngFor="let personType of TPLOV.personTypeLOV" [ngValue]="personType.TIP_NACIONALIDAD">
                    {{ personType.NOM_VALOR }}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group" [ngClass]="{'input-error': tpForm.controls['personLanguage'].invalid 
                      && (tpForm.controls['personLanguage'].dirty 
                      || tpForm.controls['personLanguage'].touched)}">
                <label for="personLanguage">Language</label>
                <select class="custom-select mr-sm-2 required" formControlName="personLanguage"
                  [(ngModel)]="thirdParty.personLanguage">
                  <option *ngFor="let personLanguage of TPLOV.personLanguageLOV" [ngValue]="personLanguage.COD_IDIOMA">
                    {{ personLanguage.NOM_IDIOMA }}
                  </option>
                </select>
                <p class="form-error" *ngIf="tpForm.controls['personLanguage'].errors?.required">
                  * language is required
                </p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div mat-dialog-actions align="end">
    <div class="btn-group" role="group">
      <button [disabled]="tpForm.invalid" type="submit" class="btn btn-primary" (click)="create()">
        Create
      </button>
      <button type="button" class="btn btn-default" (click)="cancel()">
        Clear
      </button>
    </div>
  </div>
</form>